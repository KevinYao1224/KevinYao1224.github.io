<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content=""><title>Cipolla 二次剩余算法和简要证明 | kyEEcccccc 的枢纽</title>
  <meta name="keywords" content="">
  <meta name="description" content=""><link rel="stylesheet" href="/assets/main.css?v=0.3.3" />
<script src="/assets/main.js?v=0.3.3" defer></script><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            inlineMath: [ ['$','$'] ],
            displayMath: [ ['$$', '$$'] ],
            processEscapes: true
        }
    });
</script>
<script type="text/javascript" async 
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>
</head>
<body class="body-page">
    <a href="/" class="logo"><h1>kyEEcccccc 的枢纽</h1>
</a><main class="post__wrapper"><nav class="top-nav">

<a href="/notes/" class="nav-link ">随记</a>


<a href="/articles/" class="nav-link ">文章</a>


<a href="/about-me/" class="nav-link ">关于我</a>


</nav><article class="post">
    <header class="post__header">
      <h1 class="post__title page__title">Cipolla 二次剩余算法和简要证明</h1>
    </header>
    <div class="post__content content">
      <h3 id="二次剩余的判定">二次剩余的判定</h3>

<p>在模奇素数 $p$ 意义下：</p>

<div class="kdmath">$$
a^{\frac{p-1}{2}} = \begin{cases}
1, &a \text{是二次剩余}\\
-1, &a \text{不是二次剩余}
\end{cases}
$$</div>

<p>在 $1\dots p-1$ 这些数中，恰好有二分之一（$\frac{p-1}{2}$ 个）是二次剩余，二分之一不是。</p>

<h3 id="一个同余式">一个同余式</h3>

<p>在模奇素数 $p$ 意义下：</p>

<div class="kdmath">$$
\begin{aligned}
(a+b)^p &= a^p+\binom{p}{1}a^{p-1}b+\dots+\binom{p}{p-1}ab^{p-1} + b^p\\
&= a^p+b^p
\end{aligned}
$$</div>

<p>这是因为对于奇素数 $p$ 和 $i\in[1, p-1]$，$p\mid\binom{p}{i}$。</p>

<h3 id="cipolla-算法">Cipolla 算法</h3>

<p>断言对于奇素数 $p$ 和 $(a,p) = 1$，方程 $x^2\equiv a\pmod p$ 的一个解可以用如下方式寻找：找到 $r$ 使得 $r^2-a$ 为二次非剩余，扩域令 $j^2 = r^2-a$，则 $x \equiv (a+j)^\frac{p+1}{2} \pmod {p}$。注意到这还表明 $(a+j)^\frac{p+1}{2}$ 虚部为 $0$。证明如下。</p>

<div class="kdmath">$$
\begin{aligned}
x^2 &\equiv (r+j)^p(r+j) \pmod p\\
&\equiv (r^p+j^p)(r+j) \pmod p\\
&\equiv (r+(j^2)^{\frac{p-1}{2}}\cdot j)(r+j) \pmod p\\
&\equiv (r+(r^2-a)^{\frac{p-1}{2}}\cdot j)(r+j) \pmod p\\
&\equiv (r-j)(r+j) \pmod p\\
&\equiv r^2-j^2 \pmod p\\
&\equiv r^2-(r^2-a) \pmod p\\
&\equiv a \pmod p\\
\end{aligned}
$$</div>

<p>通过随机化寻找 $r$，期望 $\Theta(1)$ 次即可找到。时间复杂度为快速幂的复杂度，即一般的 $\Theta(\log p)$。</p>

<div class="kdmath">$$
H_n=1+\frac{1}{2}+\frac{1}{3}+...+\frac{1}{n}=\sum_{i=1}^{n}\frac{1}{i}=O(\log n)
$$</div>

    </div>
  </article><aside class="post__contact"><h4><a href="">kyEEcccccc</a></h4>
  
<div class="icon__list"><a href="mailto:3044923282@qq.com" class="icon__link" target="_blank"><svg class="icon__stroke" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
  <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a><a href="https://github.com/KevinYao1224" class="icon__link" target="_blank"><svg viewBox="0 0 64 64" class="icon__fill">
  <path stroke-width="0" d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z" />
</svg>
</a></div>
</aside>
</main><footer class="site-footer">
  © 2024<a href="/">kyEEcccccc 的枢纽</a>. Theme<a href="https://github.com/erlzhang/jekyll-theme-persephone" target="_blank">Persephone</a>
</footer>

  </body>
</html>
